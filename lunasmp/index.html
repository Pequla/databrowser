<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta http-equiv="refresh" content="5"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status :: LunaSMP</title>
    <link rel="icon" type="image/png" href="https://api.mcsrvstat.us/icon/198.244.176.28:25690">
    <link href="../assets/css/custom.css" rel="stylesheet">
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-dark">
    <div class="container fw-bold text-white pt-2">
        <div class="mx-auto text-center">
            <div id="loading">
                <h1 class="fw-bold">Loading...</h1>
            </div>
            <div id="error" hidden>
                <h1 class="text-danger">Server is offline</h1>
                <p id="message"></p>
            </div>
        </div>
        <div id="status" hidden>
            <!-- Players -->
            <h1>Players:</h1>
            <p>Currently <span id="online" class="fw-bold"></span> out of <span id="max" class="fw-bold"></span> players
                online</p>
            <div>
                <ul id="list" class="list-unstyled"></ul>
            </div>

            <!-- Server -->
            <h1>Server:</h1>
            <p class="m-0">IP: <span class="fw-bold">198.244.176.28:25690</span></p>
            <p class="m-0">Version: <span id="version" class="fw-bold"></span></p>
            <p class="m-0">Discord Invite: <a href="https://discord.gg/Dcf86Hb6" target="_blank"
                    rel="noopener noreferrer" class="fw-bold">discord.gg/Dcf86Hb</a></p>
        </div>
    </div>
    <template id="player-template">
        <li>
            <img class="player-icon">
            <span class="fw-bold"><a class="player-username" href="#"></a>
        </li>
    </template>
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script>
        // 198.244.176.28:25690
        const loading = document.getElementById('loading');
        const list = document.getElementById('list');
        const template = document.getElementById('player-template');
        fetch('https://link.samifying.com/api/status/198.244.176.28/25690')
            .then(rsp => rsp.json())
            .then(data => {
                // Status
                loading.hidden = true;
                document.getElementById('status').hidden = false;
                document.getElementById('online').innerText = data.players.online;
                document.getElementById('max').innerText = data.players.max;
                if (data.players.online > 0) {
                data.players.sample.forEach(player => {
                    const copy = template.content.cloneNode(true);
                    const icon = copy.querySelector('.player-icon');
                    icon.src = 'https://visage.surgeplay.com/face/64/' + player.id;
                    icon.alt = player.name;
                    const name = copy.querySelector('.player-username');
                    name.innerText = player.name;
                    name.href = "player.html?uuid=" + player.id;
                    list.appendChild(copy);
                })};

                // Server
                document.getElementById('version').innerText = data.version.name;
            })
            .catch(e => {
                loading.hidden = true;
                document.getElementById('error').hidden = false;
                document.getElementById('message').innerText = e.message;
            });
    </script>
</body>

</html>